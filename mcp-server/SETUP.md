# Complete Setup Guide for Tyaprover MCP Server

This guide walks you through setting up the Tyaprover MCP Server for AI-powered application deployment and management.

## üöÄ Quick Start (5 minutes)

### Step 1: Install Prerequisites
```bash
# Install Node.js 18+ if not already installed
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# Install Claude Code CLI globally
npm install -g @anthropic-ai/claude-code
```

### Step 2: Setup MCP Server
```bash
# Navigate to MCP server directory
cd /path/to/tyaprover/mcp-server

# Install dependencies
npm install

# Build the server
npm run build
```

### Step 3: Configure Environment
```bash
# Copy environment template
cp .env.example .env

# Edit configuration (see Configuration section below)
nano .env
```

### Step 4: Test Installation
```bash
# Run tests
npm test

# Manual server test (should start without errors)
npm start
# Press Ctrl+C to stop
```

### Step 5: Configure Claude CLI
```bash
# Add MCP server to Claude CLI
claude config add-mcp-server tyaprover ../mcp-config-tyaprover.json

# Test AI integration
claude "list my applications"
```

## ‚öôÔ∏è Configuration

### Environment Variables (.env)

Create a `.env` file with your Tyaprover instance details:

```bash
# Required: Your Tyaprover instance URL
TYAPROVER_API_URL=https://captain.yourdomain.com

# Required: Authentication token (see Getting Auth Token below)
TYAPROVER_AUTH_TOKEN=your-token-here

# Optional: Namespace (usually 'captain')
TYAPROVER_NAMESPACE=captain

# Optional: API timeout in milliseconds
API_TIMEOUT=30000

# Optional: Logging level (error, warn, info, debug)
LOG_LEVEL=info
```

### Getting Your Auth Token

#### Method 1: Browser Developer Tools
1. Open your Tyaprover web interface
2. Open browser developer tools (F12)
3. Go to **Network** tab
4. Perform any action (like viewing apps)
5. Find an API request in the network log
6. Copy the `x-captain-auth` header value

#### Method 2: CLI Login (if available)
```bash
# If you have captain CLI installed
captain login
# Check ~/.captain directory for stored token
```

### Server Configuration (config.json)

The `config.json` file allows detailed server customization:

```json
{
  "server": {
    "name": "tyaprover",
    "version": "0.1.0"
  },
  "api": {
    "baseUrl": "https://captain.yourdomain.com",
    "version": "v2",
    "timeout": 30000,
    "retries": 3
  },
  "security": {
    "authHeader": "x-captain-auth",
    "validateCerts": true
  },
  "logging": {
    "level": "info",
    "format": "text",
    "file": null
  },
  "features": {
    "healthCheck": true,
    "metrics": false
  }
}
```

<!-- Generated by Copilot -->

## Development

### Available Scripts
- `npm start` - Start the server
- `npm run dev` - Start with nodemon for development
- `npm test` - Run tests
- `npm run lint` - Lint code
- `npm run lint:fix` - Fix linting issues

### Testing
```bash
npm test
```

### Linting
```bash
npm run lint
npm run lint:fix
```

## Docker Support

### Build and run with Docker:
```bash
docker build -t tyaprover-mcp-server .
docker run -e TYAPROVER_AUTH_TOKEN=your_token tyaprover-mcp-server
```

### Or use Docker Compose:
```bash
docker-compose up
```

## Troubleshooting

### Common Issues

1. **"API call failed" errors**
   - Check `TYAPROVER_API_URL` is correct
   - Verify `TYAPROVER_AUTH_TOKEN` is valid
   - Ensure Tyaprover instance is running

2. **"Module not found" errors**
   - Run `npm install`
   - Check Node.js version (requires >= 16.0.0)

3. **Permission denied on start.sh**
   - Run `chmod +x start.sh`

### Logging

Set `LOG_LEVEL` environment variable:
- `error` - Only errors
- `warn` - Warnings and errors
- `info` - General information (default)
- `debug` - Detailed debugging

Set `LOG_FORMAT` to `json` for structured logging.

## Generated by Copilot
